<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>H5 五子棋游戏</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">
</head>
<body>
    <noscript>
        <div class="noscript-warning">
            请启用JavaScript以体验完整的H5五子棋游戏。
        </div>
    </noscript>

    <main class="app-container">
        <header class="app-header">
            <h1>H5 五子棋</h1>
            <p class="subtitle">纯原生JavaScript实现 · 模块化架构 · Canvas渲染</p>
        </header>

        <section class="board-section">
            <canvas id="game-board" width="0" height="0">
                您的浏览器暂不支持Canvas，请升级或更换浏览器。
            </canvas>
        </section>

        <section class="controls-section">
            <div class="control-group mode-group">
                <button id="mode-pvp" type="button" class="mode-button active">PvP</button>
                <button id="mode-pve" type="button" class="mode-button">PvE</button>
                <button id="mode-eve" type="button" class="mode-button">EvE</button>
                <button id="mode-vcf" type="button" class="mode-button">VCF练习</button>
            </div>
            <div class="control-group difficulty-wrapper">
                <label for="difficulty-select">AI难度</label>
                <select id="difficulty-select">
                    <option value="BEGINNER">新手</option>
                    <option value="NORMAL" selected>普通</option>
                    <option value="HARD">困难</option>
                    <option value="HELL">地狱</option>
                </select>
            </div>
            <div class="control-group vcf-level-wrapper" style="display: none;">
                <label for="vcf-level-select">VCF难度</label>
                <select id="vcf-level-select">
                    <option value="1" selected>入门 (Level 1)</option>
                    <option value="2">初级 (Level 2)</option>
                    <option value="3">中级 (Level 3)</option>
                    <option value="4">高级 (Level 4)</option>
                </select>
            </div>
            <div class="control-group primary-actions">
                <button id="new-game-button" type="button">
                    新游戏
                </button>
                <button id="undo-button" type="button" disabled>
                    悔棋
                </button>
                <button id="hint-button" type="button" disabled>
                    💡 提示
                </button>
            </div>
            <div class="control-group save-load-group">
                <button id="save-button" type="button">保存棋局</button>
                <button id="load-button" type="button">加载棋局</button>
                <button id="auto-save-button" type="button">自动保存：关闭</button>
            </div>
            <div class="control-group replay-group">
                <button id="replay-current-button" type="button">回放当前</button>
                <button id="replay-loaded-button" type="button">回放载入</button>
                <button id="replay-stop-button" type="button">退出回放</button>
            </div>
            <div class="control-group replay-controls">
                <button id="replay-play-button" type="button">播放</button>
                <button id="replay-pause-button" type="button">暂停</button>
                <button id="replay-step-backward-button" type="button">上一步</button>
                <button id="replay-step-forward-button" type="button">下一步</button>
                <label class="replay-speed-label">
                    速度
                    <select id="replay-speed-select">
                        <option value="0.5">0.5x</option>
                        <option value="1" selected>1x</option>
                        <option value="2">2x</option>
                        <option value="3">3x</option>
                    </select>
                </label>
            </div>
            <div class="replay-progress">
                <input type="range" id="replay-progress" min="0" max="100" value="0">
                <span id="replay-progress-label">0 / 0</span>
            </div>
            <div class="control-group vcf-actions" id="vcf-actions" style="display: none;">
                <button id="vcf-start-button" type="button">开始练习</button>
                <button id="vcf-restart-button" type="button" disabled>重新开始</button>
                <button id="vcf-hint-button" type="button" disabled>查看提示</button>
                <button id="vcf-solution-button" type="button" disabled>查看解法</button>
            </div>
            <div class="vcf-status-card" id="vcf-status-card" style="display: none;">
                <div class="vcf-status-header">
                    <h3 id="vcf-puzzle-name">VCF练习未开始</h3>
                    <span class="vcf-badge" id="vcf-puzzle-level">Level 1</span>
                </div>
                <p class="vcf-description" id="vcf-puzzle-description">选择难度并点击“开始练习”</p>
                <div class="vcf-metrics">
                    <div>
                        <span class="metric-label">当前进度</span>
                        <span class="metric-value" id="vcf-progress-text">0 / 0</span>
                    </div>
                    <div>
                        <span class="metric-label">累计完成</span>
                        <span class="metric-value" id="vcf-overall-progress">0 / 40 (0%)</span>
                    </div>
                </div>
                <div class="vcf-next-step">
                    <span class="hint-label">下一关键点</span>
                    <p id="vcf-next-step-text">-</p>
                </div>
                <div class="vcf-hint-box">
                    <span class="hint-label">提示</span>
                    <p id="vcf-hint-text">-</p>
                </div>
            </div>
            <div class="status-panel" id="status-panel">
                <p>正在初始化...</p>
            </div>
        </section>

        <footer class="app-footer">
            <p>模块加载顺序: utils → game-core → ai-advanced → save-load → replay → vcf-practice → board-renderer → demo</p>
            <p class="version-info">版本: v6.0.0 (Stage 6 完成) | 
                <button id="settings-button" type="button" class="footer-link-button">⚙️ 设置</button> | 
                <button id="help-button" type="button" class="footer-link-button">❓ 帮助</button>
            </p>
        </footer>
    </main>

    <!-- 设置模态框 -->
    <div id="settings-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>⚙️ 游戏设置</h2>
                <button class="modal-close" id="settings-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="setting-item">
                    <label class="setting-label">
                        <input type="checkbox" id="setting-show-coords" class="setting-checkbox">
                        显示坐标
                    </label>
                    <p class="setting-description">在棋盘上显示坐标标识</p>
                </div>
                <div class="setting-item">
                    <label class="setting-label">
                        <input type="checkbox" id="setting-animations" class="setting-checkbox" checked>
                        动画效果
                    </label>
                    <p class="setting-description">开启界面动画效果</p>
                </div>
                <div class="setting-item">
                    <label class="setting-label">
                        <input type="checkbox" id="setting-sound" class="setting-checkbox">
                        音效（占位）
                    </label>
                    <p class="setting-description">落子音效（暂未实现）</p>
                </div>
                <div class="setting-item">
                    <label class="setting-label">
                        <input type="checkbox" id="setting-auto-hint" class="setting-checkbox" checked>
                        自动提示禁手
                    </label>
                    <p class="setting-description">在可能的禁手位置显示红色标记</p>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-button modal-button-primary" id="settings-save-button">保存设置</button>
                <button class="modal-button modal-button-secondary" id="settings-reset-button">恢复默认</button>
            </div>
        </div>
    </div>

    <!-- 帮助模态框 -->
    <div id="help-modal" class="modal-overlay" style="display: none;">
        <div class="modal-content modal-content-large">
            <div class="modal-header">
                <h2>❓ 帮助文档</h2>
                <button class="modal-close" id="help-modal-close">&times;</button>
            </div>
            <div class="modal-body">
                <div class="help-section">
                    <h3>📖 游戏规则</h3>
                    <p>五子棋是一种两人对弈的策略棋盘游戏。</p>
                    <ul>
                        <li><strong>目标</strong>：率先在棋盘上形成横、竖、斜任一方向的连续五个同色棋子</li>
                        <li><strong>规则</strong>：黑方先手，双方轮流落子，每次落一枚棋子</li>
                        <li><strong>胜利</strong>：首先形成五连者获胜</li>
                    </ul>
                </div>
                <div class="help-section">
                    <h3>⚖️ 禁手规则（仅黑方）</h3>
                    <p>为平衡先手优势，黑方受到禁手限制：</p>
                    <ul>
                        <li><strong>长连禁手</strong>：六个或更多连续同色棋子（黑方判负）</li>
                        <li><strong>三三禁手</strong>：一步棋同时形成两个或以上的活三</li>
                        <li><strong>四四禁手</strong>：一步棋同时形成两个或以上的冲四</li>
                        <li><strong>五连优先</strong>：如果一步棋同时形成五连和禁手，则五连优先，黑方获胜</li>
                    </ul>
                    <p>⚠️ 白方不受禁手限制。</p>
                </div>
                <div class="help-section">
                    <h3>🎮 游戏模式</h3>
                    <ul>
                        <li><strong>PvP</strong> - 玩家对战：双人对弈模式</li>
                        <li><strong>PvE</strong> - 人机对战：与AI对弈，可选择难度</li>
                        <li><strong>EvE</strong> - AI演示：观看AI自我对弈</li>
                        <li><strong>VCF练习</strong> - 胜利练习：40道VCF题库，4个难度等级</li>
                    </ul>
                </div>
                <div class="help-section">
                    <h3>🤖 AI难度</h3>
                    <ul>
                        <li><strong>新手</strong> - 随机落子</li>
                        <li><strong>普通</strong> - 基础评分算法</li>
                        <li><strong>困难</strong> - 高级评分+威胁分析</li>
                        <li><strong>地狱</strong> - 极限搜索+VCF检测</li>
                    </ul>
                </div>
                <div class="help-section">
                    <h3>🎯 VCF练习模式</h3>
                    <p>VCF（Victory by Continuous Four）即连续冲四杀。</p>
                    <ul>
                        <li><strong>Level 1</strong> - 入门：2-3步必胜</li>
                        <li><strong>Level 2</strong> - 初级：3-4步必胜</li>
                        <li><strong>Level 3</strong> - 中级：5-7步必胜</li>
                        <li><strong>Level 4</strong> - 高级：8-12步必胜</li>
                    </ul>
                    <p>💡 在VCF模式下，点击"查看提示"可获得下一步的提示。</p>
                </div>
                <div class="help-section">
                    <h3>⌨️ 快捷功能</h3>
                    <ul>
                        <li><strong>提示按钮</strong> - 显示AI建议的最佳落子位置（3秒冷却）</li>
                        <li><strong>悔棋</strong> - 撤销上一步棋（回放模式下不可用）</li>
                        <li><strong>保存/加载</strong> - 保存当前棋局或加载已保存的棋局</li>
                        <li><strong>回放功能</strong> - 回放当前对局或已加载的对局</li>
                    </ul>
                </div>
                <div class="help-section">
                    <h3>📱 关于项目</h3>
                    <p>H5五子棋游戏是一个纯原生JavaScript实现的Web应用，采用模块化架构设计。</p>
                    <ul>
                        <li><strong>技术栈</strong>：HTML5 Canvas + JavaScript ES6+ + CSS3</li>
                        <li><strong>特色</strong>：无框架依赖、模块化API、事件驱动架构</li>
                        <li><strong>版本</strong>：v6.0.0</li>
                    </ul>
                </div>
            </div>
            <div class="modal-footer">
                <button class="modal-button modal-button-primary" id="help-close-button">关闭</button>
            </div>
        </div>
    </div>

    <script src="js/utils.js"></script>
    <script src="js/game-core.js"></script>
    <script src="js/ai-advanced.js"></script>
    <script src="js/board-renderer.js"></script>
    <script src="js/game-save-load.js"></script>
    <script src="js/game-replay.js"></script>
    <script src="js/vcf-practice.js"></script>
    <script src="js/demo.js"></script>
</body>
</html>
